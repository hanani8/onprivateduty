import{_ as p}from"./slidev/CodeBlockWrapper.vue_vue_type_script_setup_true_lang-BQuvDlXV.js";import{b as F,o as k,w as n,g as s,e as g,m as y,z as i,v as c,x as o,E as t}from"./modules/vue-D-V5T23k.js";import{I as r}from"./slidev/default-D7QdIGX7.js";import{u as D,f as C}from"./slidev/context-CiKXUAFA.js";import"./modules/unplugin-icons-BaH8mTk-.js";import"./index-BM2v8R4J.js";import"./modules/shiki-DlUChZ4r.js";const P={__name:"slides.md__slidev_27",setup(E){const{$clicksContext:a,$frontmatter:h}=D();return a.setup(),(d,l)=>{const e=p;return k(),F(r,c(o(t(C)(t(h),26))),{default:n(()=>[l[1]||(l[1]=s("h1",null,"Fortran Code for conducting QRCP on Kahan-300",-1)),g(e,y({lines:!0,maxHeight:"500px"},{ranges:["2-27","28-31","33-37","39-46","67-69","83-85","105-124"]}),{default:n(()=>l[0]||(l[0]=[s("pre",{class:"shiki shiki-themes min-light slidev-code",style:{"--shiki-light":"#24292eff","--shiki-light-bg":"#ffffff"}},[s("code",{class:"language-fortran-free-form"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"program"),s("span",{style:{"--shiki-light":"#24292EFF"}}," run_dgeqp3_on_kahan")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    implicit"),s("span",{style:{"--shiki-light":"#D32F2F"}}," none")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Use standard double precision")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    integer"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#D32F2F"}},"parameter"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," n_dim "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 300")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#D32F2F"}},"parameter"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," zeta_val "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0.99d0"),s("span",{style:{"--shiki-light":"#C2C3C5"}}," ! Use d0 suffix")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Kahan matrix components and result")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," s_mat(n_dim, n_dim)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," k_mat(n_dim, n_dim)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," a_kahan(n_dim, n_dim) "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! This will be M = S * K")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! DGEQP3 arguments")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    integer"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," m, n, lda, info, lwork")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    integer"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," jpvt(n_dim)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," tau(n_dim) "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Size min(M,N)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#D32F2F"}},"allocatable"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," work(:)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," work_query("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! For workspace query")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Estimate Rank from Diagonal of R ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    integer"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," estimated_rank")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," tol, matrix_eps")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Local variables")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    integer"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," i, j")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    double precision"),s("span",{style:{"--shiki-light":"#D32F2F"}}," ::"),s("span",{style:{"--shiki-light":"#24292EFF"}}," phi_val")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Calculate phi")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    phi_val "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," sqrt"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#1976D2"}},"1.0d0"),s("span",{style:{"--shiki-light":"#D32F2F"}}," -"),s("span",{style:{"--shiki-light":"#24292EFF"}}," zeta_val"),s("span",{style:{"--shiki-light":"#D32F2F"}},"**"),s("span",{style:{"--shiki-light":"#1976D2"}},"2"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Use d0 suffix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Using N ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim, "),s("span",{style:{"--shiki-light":"#22863A"}},'", ZETA ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", zeta_val, "),s("span",{style:{"--shiki-light":"#22863A"}},'", PHI ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", phi_val")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Construct S_n Matrix ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    s_mat "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0.0d0"),s("span",{style:{"--shiki-light":"#C2C3C5"}}," ! Use d0 suffix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    do"),s("span",{style:{"--shiki-light":"#24292EFF"}}," i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"        s_mat(i, i) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," zeta_val"),s("span",{style:{"--shiki-light":"#D32F2F"}},"**"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"-"),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    end do")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Construct K_n Matrix ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    k_mat "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0.0d0"),s("span",{style:{"--shiki-light":"#C2C3C5"}}," ! Use d0 suffix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    do"),s("span",{style:{"--shiki-light":"#24292EFF"}}," i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"        k_mat(i, i) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1.0d0"),s("span",{style:{"--shiki-light":"#C2C3C5"}}," ! Use d0 suffix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        do"),s("span",{style:{"--shiki-light":"#24292EFF"}}," j "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"+"),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Elements above the diagonal")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"            k_mat(i, j) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#D32F2F"}}," -"),s("span",{style:{"--shiki-light":"#24292EFF"}},"phi_val")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        end do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    end do")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Compute Kahan Matrix M = S_n * K_n ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    a_kahan "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," matmul"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(s_mat, k_mat)")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Print a small part of the Kahan matrix for verification ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Top-left 5x5 block of the generated Kahan matrix A:"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    do"),s("span",{style:{"--shiki-light":"#24292EFF"}}," i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#6F42C1"}},"min"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#1976D2"}},"5"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        write"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#D32F2F"}},"*"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},"'(5(E13.5, 1X))'"),s("span",{style:{"--shiki-light":"#24292EFF"}},") (a_kahan(i, j), j "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#6F42C1"}},"min"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#1976D2"}},"5"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim))")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    end do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Set up DGEQP3 parameters ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    m "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," n_dim     "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Number of rows")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    n "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," n_dim     "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Number of columns")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    lda "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," n_dim   "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Leading dimension of A")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Initialize JPVT for DGEQP3 ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Set JPVT(j) = 0 to indicate column j is free to be pivoted.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    jpvt "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Workspace Query for DGEQP3 ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    lwork "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," -1"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Signal for workspace query")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    call"),s("span",{style:{"--shiki-light":"#6F42C1"}}," dgeqp3"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(m, n, a_kahan, lda, jpvt, tau, work_query, lwork, info)")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," (info "),s("span",{style:{"--shiki-light":"#D32F2F"}},"/="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Error during DGEQP3 workspace query. INFO ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", info")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        stop"),s("span",{style:{"--shiki-light":"#1976D2"}}," 1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    end if")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    lwork "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," int"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(work_query("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},")) "),s("span",{style:{"--shiki-light":"#C2C3C5"}},"! Get optimal workspace size")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    allocate"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(work(lwork))")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Optimal LWORK calculated for DGEQP3:"'),s("span",{style:{"--shiki-light":"#24292EFF"}},", lwork")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Reset JPVT before the actual call (important!) ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    jpvt "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Call DGEQP3 to perform QR with Column Pivoting ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Note: a_kahan will be overwritten with R and factorization info (Q details)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    call"),s("span",{style:{"--shiki-light":"#6F42C1"}}," dgeqp3"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(m, n, a_kahan, lda, jpvt, tau, work, lwork, info)")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Check for errors ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," (info "),s("span",{style:{"--shiki-light":"#D32F2F"}},"<"),s("span",{style:{"--shiki-light":"#1976D2"}}," 0"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Error in DGEQP3 call: Argument"'),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#D32F2F"}},"-"),s("span",{style:{"--shiki-light":"#24292EFF"}},"info, "),s("span",{style:{"--shiki-light":"#22863A"}},'"had an illegal value."')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    else if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," (info "),s("span",{style:{"--shiki-light":"#D32F2F"}},">"),s("span",{style:{"--shiki-light":"#1976D2"}}," 0"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        ! Note: DGEQP3 INFO > 0 is unlikely/not defined for standard errors")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Warning/Error from DGEQP3 computation. INFO ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", info")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    else")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"DGEQP3 completed successfully. INFO = 0"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    end if")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," (info "),s("span",{style:{"--shiki-light":"#D32F2F"}},"=="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then"),s("span",{style:{"--shiki-light":"#C2C3C5"}}," ! Proceed only if DGEQP3 was successful")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," ("),s("span",{style:{"--shiki-light":"#6F42C1"}},"min"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(m, n) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"=="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0"),s("span",{style:{"--shiki-light":"#24292EFF"}},") "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"            estimated_rank "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        else")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"            ! Get machine epsilon for the precision of a_kahan")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"            matrix_eps "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," epsilon"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(a_kahan("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},"))")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"            ! Calculate tolerance relative to R(1,1) = a_kahan(1,1)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"            tol "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," max"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(m, n) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"*"),s("span",{style:{"--shiki-light":"#24292EFF"}}," matrix_eps "),s("span",{style:{"--shiki-light":"#D32F2F"}},"*"),s("span",{style:{"--shiki-light":"#6F42C1"}}," abs"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(a_kahan("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},"))")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"            ! Handle case where R(1,1) is essentially zero")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"            if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," ("),s("span",{style:{"--shiki-light":"#6F42C1"}},"abs"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(a_kahan("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},","),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#24292EFF"}},")) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"<="),s("span",{style:{"--shiki-light":"#24292EFF"}}," tol) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"                 estimated_rank "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"            else")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"                ! Assume rank is at least 1 if R(1,1) > tol")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"                estimated_rank "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"                ! Find the largest k such that abs(R(k,k)) > tol")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                do"),s("span",{style:{"--shiki-light":"#24292EFF"}}," i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 2"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#6F42C1"}},"min"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(m, n)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," ("),s("span",{style:{"--shiki-light":"#6F42C1"}},"abs"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(a_kahan(i, i)) "),s("span",{style:{"--shiki-light":"#D32F2F"}},">"),s("span",{style:{"--shiki-light":"#24292EFF"}}," tol) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"then")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"                        estimated_rank "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," i")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                    else")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"                        ! First element below tolerance found, stop. Rank is i-1.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                        exit")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                    end if")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"                end do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"             endif")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        endif")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Estimated Numerical Rank (based on R diagonal):"'),s("span",{style:{"--shiki-light":"#24292EFF"}},", estimated_rank")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"  (Using tolerance ="'),s("span",{style:{"--shiki-light":"#24292EFF"}},", tol, "),s("span",{style:{"--shiki-light":"#22863A"}},'")"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    else")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Rank estimation skipped due to DGEQP3 error."')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    endif")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print*"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Print Results ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! DGEQP3 doesn't return rank/condition estimates directly.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! Rank could be estimated by examining the diagonal of R in A.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Factorization complete. Examine JPVT and the upper triangle of A (contains R)."')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'"Permutation Vector (JPVT):"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    write"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#D32F2F"}},"*"),s("span",{style:{"--shiki-light":"#24292EFF"}},","),s("span",{style:{"--shiki-light":"#22863A"}},"'(20I5)'"),s("span",{style:{"--shiki-light":"#24292EFF"}},") (jpvt(i), i "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}}," 1"),s("span",{style:{"--shiki-light":"#24292EFF"}},", n_dim)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    print"),s("span",{style:{"--shiki-light":"#D32F2F"}}," *"),s("span",{style:{"--shiki-light":"#24292EFF"}},", "),s("span",{style:{"--shiki-light":"#22863A"}},'""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},'    ! print *, "Print bottom 10x10 block of the resulting R matrix (in A):"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! do i = 1, 10")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    !     write(*, '(10(E13.5, 1X))') (a_kahan(n_dim - 9 + i, j), j = 1, 10)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! end do")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},'    ! print *, ""')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ! --- Clean up ---")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    deallocate"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(work)")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"end program"),s("span",{style:{"--shiki-light":"#24292EFF"}}," run_dgeqp3_on_kahan")])])],-1)])),_:1},16)]),_:1},16)}}};export{P as default};
