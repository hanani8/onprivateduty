import{_ as r}from"./CodeBlockWrapper.vue_vue_type_script_setup_true_lang-BQuvDlXV.js";import{d,f as m,o,g as s,j as e,n as a,b as E,w as h,e as k,m as y,z as i,v as D,x as f,E as F}from"../modules/vue-D-V5T23k.js";import{_ as u}from"../index-BM2v8R4J.js";import{u as _,f as I}from"./context-CiKXUAFA.js";import"../modules/unplugin-icons-BaH8mTk-.js";import"../modules/shiki-DlUChZ4r.js";const T={class:"col-header"},v=d({__name:"two-cols-header",props:{class:{type:String},layoutClass:{type:String}},setup(p){const n=p;return(l,C)=>(o(),m("div",{class:a(["slidev-layout two-cols-header w-full h-full",p.layoutClass])},[s("div",T,[e(l.$slots,"default",{},void 0,!0)]),s("div",{class:a(["col-left",n.class])},[e(l.$slots,"left",{},void 0,!0)],2),s("div",{class:a(["col-right",n.class])},[e(l.$slots,"right",{},void 0,!0)],2),s("div",{class:a(["col-bottom",n.class])},[e(l.$slots,"bottom",{},void 0,!0)],2)],2))}}),W=u(v,[["__scopeId","data-v-5e754fcf"]]),R={__name:"slides.md__slidev_83",setup(p){const{$clicksContext:n,$frontmatter:l}=_();return n.setup(),(C,t)=>{const g=r;return o(),E(W,D(f(F(I)(F(l),82))),{left:h(c=>[k(g,y({maxHeight:"400px"},{ranges:["all"]}),{default:h(()=>t[0]||(t[0]=[s("pre",{class:"shiki shiki-themes min-light slidev-code",style:{"--shiki-light":"#24292eff","--shiki-light-bg":"#ffffff"}},[s("code",{class:"language-python"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"def"),s("span",{style:{"--shiki-light":"#6F42C1"}}," getID"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#FF9800"}},"k"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#FF9800"}}," Z"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#FF9800"}}," W"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}},"None"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#FF9800"}}," mode"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#22863A"}},"'kT'"),s("span",{style:{"--shiki-light":"#24292EFF"}},"):")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    '''")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Calculate ID (Interpolative Decomposition) of activation matrix Z")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Args:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        k: number of columns to keep (size of subset I)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        Z: activation matrix after nonlinearity, shape (d, n)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        W: weight matrix (optional)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        mode: what to return ('kT' or 'WT')")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Returns:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        I: indices of selected neurons")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        T: interpolation matrix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Based on the mathematical formulation:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Z^T ≈ (Z^T)_{:,I} T where |I| = k")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    '''")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    assert"),s("span",{style:{"--shiki-light":"#24292EFF"}},"(k "),s("span",{style:{"--shiki-light":"#D32F2F"}},"<="),s("span",{style:{"--shiki-light":"#24292EFF"}}," Z"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#24292EFF"}},"shape"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#212121"}},"]"),s("span",{style:{"--shiki-light":"#24292EFF"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # column-pivot QR")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    R"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," P "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," scipy"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#24292EFF"}},"linalg"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"qr"),s("span",{style:{"--shiki-light":"#212121"}},"((Z), mode"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#22863A"}},"'r'"),s("span",{style:{"--shiki-light":"#212121"}},", pivoting"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}},"True"),s("span",{style:{"--shiki-light":"#212121"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    I "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," P"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#1976D2"}},"0"),s("span",{style:{"--shiki-light":"#212121"}},":"),s("span",{style:{"--shiki-light":"#24292EFF"}},"k"),s("span",{style:{"--shiki-light":"#212121"}},"]"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"  # Selected indices I")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," W "),s("span",{style:{"--shiki-light":"#D32F2F"}},"is"),s("span",{style:{"--shiki-light":"#D32F2F"}}," not"),s("span",{style:{"--shiki-light":"#1976D2"}}," None"),s("span",{style:{"--shiki-light":"#212121"}},":"),s("span",{style:{"--shiki-light":"#24292EFF"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"        W_I "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," W"),s("span",{style:{"--shiki-light":"#212121"}},"[:,"),s("span",{style:{"--shiki-light":"#24292EFF"}}," I"),s("span",{style:{"--shiki-light":"#212121"}},"]"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"  # Selected weights W_{:,I}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Compute interpolation matrix T")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    T "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," np"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"concatenate"),s("span",{style:{"--shiki-light":"#212121"}},"((")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#212121"}},"        np."),s("span",{style:{"--shiki-light":"#6F42C1"}},"identity"),s("span",{style:{"--shiki-light":"#212121"}},"(k),")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#212121"}},"        np.linalg."),s("span",{style:{"--shiki-light":"#6F42C1"}},"pinv"),s("span",{style:{"--shiki-light":"#212121"}},"(R["),s("span",{style:{"--shiki-light":"#1976D2"}},"0"),s("span",{style:{"--shiki-light":"#212121"}},":k, "),s("span",{style:{"--shiki-light":"#1976D2"}},"0"),s("span",{style:{"--shiki-light":"#212121"}},":k]) "),s("span",{style:{"--shiki-light":"#D32F2F"}},"@"),s("span",{style:{"--shiki-light":"#212121"}}," R["),s("span",{style:{"--shiki-light":"#1976D2"}},"0"),s("span",{style:{"--shiki-light":"#212121"}},":k, k:"),s("span",{style:{"--shiki-light":"#1976D2"}},"None"),s("span",{style:{"--shiki-light":"#212121"}},"]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#212121"}},"    ), axis"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#212121"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    T "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," T"),s("span",{style:{"--shiki-light":"#212121"}},"[:,"),s("span",{style:{"--shiki-light":"#24292EFF"}}," np"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"argsort"),s("span",{style:{"--shiki-light":"#212121"}},"(P)]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#24292EFF"}}," mode "),s("span",{style:{"--shiki-light":"#D32F2F"}},"=="),s("span",{style:{"--shiki-light":"#22863A"}}," 'kT'"),s("span",{style:{"--shiki-light":"#212121"}},":")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        return"),s("span",{style:{"--shiki-light":"#24292EFF"}}," I"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," T")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    elif"),s("span",{style:{"--shiki-light":"#24292EFF"}}," mode "),s("span",{style:{"--shiki-light":"#D32F2F"}},"=="),s("span",{style:{"--shiki-light":"#22863A"}}," 'WT'"),s("span",{style:{"--shiki-light":"#D32F2F"}}," and"),s("span",{style:{"--shiki-light":"#24292EFF"}}," W "),s("span",{style:{"--shiki-light":"#D32F2F"}},"is"),s("span",{style:{"--shiki-light":"#D32F2F"}}," not"),s("span",{style:{"--shiki-light":"#1976D2"}}," None"),s("span",{style:{"--shiki-light":"#212121"}},":")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        return"),s("span",{style:{"--shiki-light":"#24292EFF"}}," W_I"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," T")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    else"),s("span",{style:{"--shiki-light":"#212121"}},":")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"        raise"),s("span",{style:{"--shiki-light":"#1976D2"}}," NotImplementedError")])])],-1)])),_:1},16)]),right:h(c=>[k(g,y({maxHeight:"400px"},{ranges:["all"]}),{default:h(()=>t[1]||(t[1]=[s("pre",{class:"shiki shiki-themes min-light slidev-code",style:{"--shiki-light":"#24292eff","--shiki-light-bg":"#ffffff"}},[s("code",{class:"language-python"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"def"),s("span",{style:{"--shiki-light":"#6F42C1"}}," compress_model_ID"),s("span",{style:{"--shiki-light":"#24292EFF"}},"("),s("span",{style:{"--shiki-light":"#FF9800"}},"model"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#FF9800"}}," X"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#FF9800"}}," k"),s("span",{style:{"--shiki-light":"#24292EFF"}},"):")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},'    """')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Compress model using interpolative decomposition")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Following the mathematical formulation:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    h_FC(x; W, U) ≈ h_FC(x; W_{:,I}, T U)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Args:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        model: original model with parameters W, U")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        X: pruning dataset ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        k: target width (number of neurons to keep)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    Returns:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        compressed_model: model with parameters W_{:,I}, TU")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        I: indices of selected neurons")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        T: interpolation matrix")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},'    """')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    X_tensor "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," torch"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"FloatTensor"),s("span",{style:{"--shiki-light":"#212121"}},"(X)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Get activations Z = g(W^T X)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    Z "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," model"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"get_activations"),s("span",{style:{"--shiki-light":"#212121"}},"(X_tensor)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Transpose Z to have shape (d, n) as expected by getID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Z = Z.T")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Get model parameters W and U")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    W"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," b1"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," U"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," b2 "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," model"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"get_params"),s("span",{style:{"--shiki-light":"#212121"}},"()")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Apply interpolative decomposition: Z^T ≈ (Z^T)_{:,I} T")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    I"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," T "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," getID"),s("span",{style:{"--shiki-light":"#212121"}},"(k, Z, mode"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#22863A"}},"'kT'"),s("span",{style:{"--shiki-light":"#212121"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Ensure indices I are properly formatted and within bounds")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    I "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," np"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"array"),s("span",{style:{"--shiki-light":"#212121"}},"(I)."),s("span",{style:{"--shiki-light":"#6F42C1"}},"astype"),s("span",{style:{"--shiki-light":"#212121"}},"("),s("span",{style:{"--shiki-light":"#1976D2"}},"int"),s("span",{style:{"--shiki-light":"#212121"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    I "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," I"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#24292EFF"}},"I "),s("span",{style:{"--shiki-light":"#D32F2F"}},"<"),s("span",{style:{"--shiki-light":"#24292EFF"}}," W"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#24292EFF"}},"shape"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#1976D2"}},"0"),s("span",{style:{"--shiki-light":"#212121"}},"]]"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"  # Ensure indices are within bounds")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    if"),s("span",{style:{"--shiki-light":"#6F42C1"}}," len"),s("span",{style:{"--shiki-light":"#212121"}},"(I)"),s("span",{style:{"--shiki-light":"#D32F2F"}}," <"),s("span",{style:{"--shiki-light":"#24292EFF"}}," k"),s("span",{style:{"--shiki-light":"#212121"}},":")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1"}},"        print"),s("span",{style:{"--shiki-light":"#212121"}},"("),s("span",{style:{"--shiki-light":"#D32F2F"}},"f"),s("span",{style:{"--shiki-light":"#22863A"}},'"Warning: Only '),s("span",{style:{"--shiki-light":"#1976D2"}},"{"),s("span",{style:{"--shiki-light":"#6F42C1"}},"len"),s("span",{style:{"--shiki-light":"#212121"}},"(I)"),s("span",{style:{"--shiki-light":"#1976D2"}},"}"),s("span",{style:{"--shiki-light":"#22863A"}}," valid indices found, expected "),s("span",{style:{"--shiki-light":"#1976D2"}},"{"),s("span",{style:{"--shiki-light":"#212121"}},"k"),s("span",{style:{"--shiki-light":"#1976D2"}},"}"),s("span",{style:{"--shiki-light":"#22863A"}},'"'),s("span",{style:{"--shiki-light":"#212121"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"        # If we have fewer indices than expected, adjust T accordingly")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"        T "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," T"),s("span",{style:{"--shiki-light":"#212121"}},"[:"),s("span",{style:{"--shiki-light":"#6F42C1"}},"len"),s("span",{style:{"--shiki-light":"#212121"}},"(I),"),s("span",{style:{"--shiki-light":"#212121"}}," :]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Create new weights for the compressed model:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # W_hat = W_{:,I} ∈ R^{d×k}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # U_hat = TU ∈ R^{k×c}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    W_hat "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," W"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#24292EFF"}},"I"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#212121"}}," :]"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"  # Select columns of W corresponding to I")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    b1_hat "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," b1"),s("span",{style:{"--shiki-light":"#212121"}},"["),s("span",{style:{"--shiki-light":"#24292EFF"}},"I"),s("span",{style:{"--shiki-light":"#212121"}},"]"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"   # Select biases corresponding to I")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    U_hat "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#24292EFF"}}," (U "),s("span",{style:{"--shiki-light":"#D32F2F"}},"@"),s("span",{style:{"--shiki-light":"#24292EFF"}}," T"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#24292EFF"}},"T)"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"reshape"),s("span",{style:{"--shiki-light":"#212121"}},"("),s("span",{style:{"--shiki-light":"#1976D2"}},"1"),s("span",{style:{"--shiki-light":"#212121"}},", "),s("span",{style:{"--shiki-light":"#6F42C1"}},"len"),s("span",{style:{"--shiki-light":"#212121"}},"(I))"),s("span",{style:{"--shiki-light":"#C2C3C5"}},"  # T U is the new output layer weight")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#C2C3C5"}},"    # Create new model with compressed weights")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    compressed_model "),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}}," MinimalXORModel"),s("span",{style:{"--shiki-light":"#212121"}},"(hidden_size"),s("span",{style:{"--shiki-light":"#D32F2F"}},"="),s("span",{style:{"--shiki-light":"#6F42C1"}},"len"),s("span",{style:{"--shiki-light":"#212121"}},"(I))")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    compressed_model"),s("span",{style:{"--shiki-light":"#212121"}},"."),s("span",{style:{"--shiki-light":"#6F42C1"}},"set_params"),s("span",{style:{"--shiki-light":"#212121"}},"(W_hat, b1_hat, U_hat, b2)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292EFF"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D32F2F"}},"    return"),s("span",{style:{"--shiki-light":"#24292EFF"}}," compressed_model"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," I"),s("span",{style:{"--shiki-light":"#212121"}},","),s("span",{style:{"--shiki-light":"#24292EFF"}}," T")])])],-1)])),_:1},16)]),default:h(()=>[t[2]||(t[2]=s("h1",null,"Code",-1))]),_:1},16)}}};export{R as default};
