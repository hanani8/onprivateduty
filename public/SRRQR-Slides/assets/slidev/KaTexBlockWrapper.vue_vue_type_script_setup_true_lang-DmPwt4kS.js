import{d as A,r as C,J as _,K as k,A as y,L as E,f as I,o as x,j as K}from"../modules/vue-D-V5T23k.js";import{m as b,C as N,h as q,p as B,j as M}from"../index-BM2v8R4J.js";import{u as P}from"./context-CiKXUAFA.js";const w=A({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(S){const e=S,{$clicksContext:a}=P(),o=C(),f=b();return _(()=>{a.unregister(f)}),k(()=>{var p;if(!a||!((p=e.ranges)!=null&&p.length))return;const s=a.calculateSince(e.at,e.ranges.length-1);a.register(f,s);const i=y(()=>s?Math.max(0,a.current-s.start+1):N),g=y(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());E(()=>{if(!o.value)return;let c=e.ranges[i.value]??g.value;const h=c==="hide";o.value.classList.toggle(q,h),h&&(c=e.ranges[i.value+1]??g.value);const m=o.value.querySelectorAll(".mtable > [class*=col-align]");if(!m)return;const L=Array.from(m).map(n=>Array.from(n.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),r=[];for(const n of L)n.forEach((l,t)=>{l&&(Array.isArray(r[t])?r[t].push(l):r[t]=[l])});const d=e.startLine,v=B(r.length+d-1,c);r.forEach((n,l)=>{const t=v.includes(l+d);n.forEach(u=>{u.classList.toggle(M,!0),u.classList.toggle("highlighted",t),u.classList.toggle("dishonored",!t)})})})}),(s,i)=>(x(),I("div",{ref_key:"el",ref:o,class:"slidev-katex-wrapper"},[K(s.$slots,"default")],512))}});export{w as _};
